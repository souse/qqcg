define("pafweblib/pwdGrd/1.0.1/pc-b-password",["./encryptor","./password-rule"],function(a,b){function c(){$("form").submit(function(){$("form").find(".encrypted-password, .plugin-encrypted-password").each(function(){var a=$(this),b=$("#"+a.prop("id")+"_"),c=$.trim(a.val());c&&c.length>0&&b.val(g(c))})}),$(".encrypted-password, .plugin-encrypted-password").each(function(){var a=$(this);$("<input type='hidden' name='"+a.prop("name")+"' id='"+a.prop("id")+"_"+"'/>").appendTo(a.closest("form"));var b=a.css("visibility","visible")[0];b.removeAttribute("disabled"),b.removeAttribute("name")}),$("[data-matching-group]").each(function(){var a=$(this).data("matchingGroup"),b=$('[data-matching-group="'+a+'"]'),c=b.last();c.on("validate",function(c,d){if(!(b.length<2)){var e,f;b.each(function(){if(e){if(f=$(this).val(),e!==f&&""!==f)return d.reject(a+"不一致"),!1}else e=$(this).val()})}})})}function d(){i.on("validate",function(a,b){var c=$(this),d=c.val();if(null==d||0==$.trim(d).length)return $(this).trigger("displayStrength",[-1]),b.reject("密码不能为空"),!1;if(!h.validCharSet(d))return $(this).trigger("displayStrength",[-1]),b.reject("密码不可用"),!1;if(h.isInBlackList(d))return $(this).trigger("displayStrength",[-1]),b.reject("您设置的密码太简单啦^_^"),!1;if(c.hasClass("password-min-6")){if(h.lessLength(d,6))return $(this).trigger("displayStrength",[-1]),b.reject("密码长度需要是6位以上"),!1}else if(h.lessLength(d,8))return $(this).trigger("displayStrength",[-1]),b.reject("密码长度需要是8位以上"),!1;return h.moreLength(d)?($(this).trigger("displayStrength",[-1]),b.reject("密码长度需要是16位以下"),!1):c.hasClass("password-min-6")||h.validCharSetGroup(d)?void 0:($(this).trigger("displayStrength",[-1]),b.reject("大写字母、小写字母、数字、特殊字符至少包含2种"),!1)}),i.on("afterValidate",function(){var a=$(this).val(),b=h.entropyScore(a),c=0;return""!=a&&h.validCharSet(a)?h.isInBlackList(a)?($(this).trigger("displayStrength",[0,b,!0]),void 0):(c=isNaN(b)?0:30>=b?1:60>=b?2:3,$(this).parents(j).trigger("displayStrength",[c,b]),void 0):($(this).trigger("displayStrength",[-1]),void 0)}),$("body").on("displayStrength",j,function(a,b,c,d){for(var e=["invalid","weak","medium","strong"],f=0;f<e.length;f++)$(this).removeClass(e[f]);$(this).addClass(e[b]),$(this).find("input.strength").val(b),d||$(this).children(".greyListTip").hide()})}function e(){$(".passwordHolder").each(function(){var a=$(this).find(".password-ruled").prop("name");$(this).append("<div class='strongShow'><span class='s2'>弱</span><span class='s3'>中</span><span class='s4'>强</span></div>"),$(this).append('<input type="hidden" class="strength" name="'+a+'Strength" value="" />')})}function f(){e(),c(),d()}var g=a("./encryptor"),h=a("./password-rule"),i=$(".password-ruled"),j=".passwordHolder";f(),b.entropyScoreByPatternLength=h.entropyScoreByPatternLength}),define("pafweblib/pwdGrd/1.0.1/encryptor",[],function(){function a(a){var b="0123456789abcdef",c=[a.length/2],d=new window.Array;for(i=0;c>i;i++)d[i]=16*b.indexOf(a.charAt(2*i+0))+b.indexOf(a.charAt(2*i+1));return d}function b(a){var b="0123456789abcdef",c="";for(i=0;i<a.length;i++){var d=a[i]%16,e=a[i]-a[i]%16;e/=16,c+=b.substring(e,e+1)+""+b.substring(d,d+1)}return c}function c(){}function d(a){var b,c,d="";for(b=0;b+3<=a.length;b+=3)c=window.parseInt(a.substring(b,b+3),16),d+=sb.charAt(c>>6)+sb.charAt(63&c);for(b+1==a.length?(c=window.parseInt(a.substring(b,b+1),16),d+=sb.charAt(c<<2)):b+2==a.length&&(c=window.parseInt(a.substring(b,b+2),16),d+=sb.charAt(c>>2)+sb.charAt((3&c)<<4));(3&d.length)>0;)d+=tb;return d}function e(a,b,c){null!=a&&("number"==typeof a?this.fromNumber(a,b,c):null==b&&"string"!=typeof a?this.fromString(a,256):this.fromString(a,b))}function f(){return new e(null)}function g(a,b,c,d,e,f){for(;--f>=0;){var g=b*this[a++]+c[d]+e;e=Math.floor(g/67108864),c[d++]=67108863&g}return e}function h(a,b,c,d,e,f){for(var g=32767&b,h=b>>15;--f>=0;){var i=32767&this[a],j=this[a++]>>15,k=h*i+j*g;i=g*i+((32767&k)<<15)+c[d]+(1073741823&e),e=(i>>>30)+(k>>>15)+h*j+(e>>>30),c[d++]=1073741823&i}return e}function k(a,b,c,d,e,f){for(var g=16383&b,h=b>>14;--f>=0;){var i=16383&this[a],j=this[a++]>>14,k=h*i+j*g;i=g*i+((16383&k)<<14)+c[d]+e,e=(i>>28)+(k>>14)+h*j,c[d++]=268435455&i}return e}function l(a){return zb.charAt(a)}function m(a,b){var c=Ab[a.charCodeAt(b)];return null==c?-1:c}function n(a){for(var b=this.t-1;b>=0;--b)a[b]=this[b];a.t=this.t,a.s=this.s}function o(a){this.t=1,this.s=0>a?-1:0,a>0?this[0]=a:-1>a?this[0]=a+DV:this.t=0}function p(a){var b=f();return b.fromInt(a),b}function q(a,b){var c;if(16==b)c=4;else if(8==b)c=3;else if(256==b)c=8;else if(2==b)c=1;else if(32==b)c=5;else{if(4!=b)return this.fromRadix(a,b),void 0;c=2}this.t=0,this.s=0;for(var d=a.length,f=!1,g=0;--d>=0;){var h=8==c?255&a[d]:m(a,d);0>h?"-"==a.charAt(d)&&(f=!0):(f=!1,0==g?this[this.t++]=h:g+c>this.DB?(this[this.t-1]|=(h&(1<<this.DB-g)-1)<<g,this[this.t++]=h>>this.DB-g):this[this.t-1]|=h<<g,g+=c,g>=this.DB&&(g-=this.DB))}8==c&&0!=(128&a[0])&&(this.s=-1,g>0&&(this[this.t-1]|=(1<<this.DB-g)-1<<g)),this.clamp(),f&&e.ZERO.subTo(this,this)}function r(){for(var a=this.s&this.DM;this.t>0&&this[this.t-1]==a;)--this.t}function t(a){if(this.s<0)return"-"+this.negate().toString(a);var b;if(16==a)b=4;else if(8==a)b=3;else if(2==a)b=1;else if(32==a)b=5;else{if(4!=a)return this.toRadix(a);b=2}var c,d=(1<<b)-1,e=!1,f="",g=this.t,h=this.DB-g*this.DB%b;if(g-->0)for(h<this.DB&&(c=this[g]>>h)>0&&(e=!0,f=l(c));g>=0;)b>h?(c=(this[g]&(1<<h)-1)<<b-h,c|=this[--g]>>(h+=this.DB-b)):(c=this[g]>>(h-=b)&d,0>=h&&(h+=this.DB,--g)),c>0&&(e=!0),e&&(f+=l(c));return e?f:"0"}function u(){var a=f();return e.ZERO.subTo(this,a),a}function v(){return this.s<0?this.negate():this}function w(a){var b=this.s-a.s;if(0!=b)return b;var c=this.t;if(b=c-a.t,0!=b)return b;for(;--c>=0;)if(0!=(b=this[c]-a[c]))return b;return 0}function y(a){var b,c=1;return 0!=(b=a>>>16)&&(a=b,c+=16),0!=(b=a>>8)&&(a=b,c+=8),0!=(b=a>>4)&&(a=b,c+=4),0!=(b=a>>2)&&(a=b,c+=2),0!=(b=a>>1)&&(a=b,c+=1),c}function z(){return this.t<=0?0:this.DB*(this.t-1)+y(this[this.t-1]^this.s&this.DM)}function A(a,b){var c;for(c=this.t-1;c>=0;--c)b[c+a]=this[c];for(c=a-1;c>=0;--c)b[c]=0;b.t=this.t+a,b.s=this.s}function B(a,b){for(var c=a;c<this.t;++c)b[c-a]=this[c];b.t=Math.max(this.t-a,0),b.s=this.s}function C(a,b){var c,d=a%this.DB,e=this.DB-d,f=(1<<e)-1,g=Math.floor(a/this.DB),h=this.s<<d&this.DM;for(c=this.t-1;c>=0;--c)b[c+g+1]=this[c]>>e|h,h=(this[c]&f)<<d;for(c=g-1;c>=0;--c)b[c]=0;b[g]=h,b.t=this.t+g+1,b.s=this.s,b.clamp()}function D(a,b){b.s=this.s;var c=Math.floor(a/this.DB);if(c>=this.t)return b.t=0,void 0;var d=a%this.DB,e=this.DB-d,f=(1<<d)-1;b[0]=this[c]>>d;for(var g=c+1;g<this.t;++g)b[g-c-1]|=(this[g]&f)<<e,b[g-c]=this[g]>>d;d>0&&(b[this.t-c-1]|=(this.s&f)<<e),b.t=this.t-c,b.clamp()}function E(a,b){for(var c=0,d=0,e=Math.min(a.t,this.t);e>c;)d+=this[c]-a[c],b[c++]=d&this.DM,d>>=this.DB;if(a.t<this.t){for(d-=a.s;c<this.t;)d+=this[c],b[c++]=d&this.DM,d>>=this.DB;d+=this.s}else{for(d+=this.s;c<a.t;)d-=a[c],b[c++]=d&this.DM,d>>=this.DB;d-=a.s}b.s=0>d?-1:0,-1>d?b[c++]=this.DV+d:d>0&&(b[c++]=d),b.t=c,b.clamp()}function F(a,b){var c=this.abs(),d=a.abs(),f=c.t;for(b.t=f+d.t;--f>=0;)b[f]=0;for(f=0;f<d.t;++f)b[f+c.t]=c.am(0,d[f],b,f,0,c.t);b.s=0,b.clamp(),this.s!=a.s&&e.ZERO.subTo(b,b)}function G(a){for(var b=this.abs(),c=a.t=2*b.t;--c>=0;)a[c]=0;for(c=0;c<b.t-1;++c){var d=b.am(c,b[c],a,2*c,0,1);(a[c+b.t]+=b.am(c+1,2*b[c],a,2*c+1,d,b.t-c-1))>=b.DV&&(a[c+b.t]-=b.DV,a[c+b.t+1]=1)}a.t>0&&(a[a.t-1]+=b.am(c,b[c],a,2*c,0,1)),a.s=0,a.clamp()}function H(a,b,c){var d=a.abs();if(!(d.t<=0)){var g=this.abs();if(g.t<d.t)return null!=b&&b.fromInt(0),null!=c&&this.copyTo(c),void 0;null==c&&(c=f());var h=f(),i=this.s,j=a.s,k=this.DB-y(d[d.t-1]);k>0?(d.lShiftTo(k,h),g.lShiftTo(k,c)):(d.copyTo(h),g.copyTo(c));var l=h.t,m=h[l-1];if(0!=m){var n=m*(1<<this.F1)+(l>1?h[l-2]>>this.F2:0),o=this.FV/n,p=(1<<this.F1)/n,q=1<<this.F2,r=c.t,s=r-l,t=null==b?f():b;for(h.dlShiftTo(s,t),c.compareTo(t)>=0&&(c[c.t++]=1,c.subTo(t,c)),e.ONE.dlShiftTo(l,t),t.subTo(h,h);h.t<l;)h[h.t++]=0;for(;--s>=0;){var u=c[--r]==m?this.DM:Math.floor(c[r]*o+(c[r-1]+q)*p);if((c[r]+=h.am(0,u,c,s,0,l))<u)for(h.dlShiftTo(s,t),c.subTo(t,c);c[r]<--u;)c.subTo(t,c)}null!=b&&(c.drShiftTo(l,b),i!=j&&e.ZERO.subTo(b,b)),c.t=l,c.clamp(),k>0&&c.rShiftTo(k,c),0>i&&e.ZERO.subTo(c,c)}}}function I(a){var b=f();return this.abs().divRemTo(a,null,b),this.s<0&&b.compareTo(e.ZERO)>0&&a.subTo(b,b),b}function J(a){this.m=a}function K(a){return a.s<0||a.compareTo(this.m)>=0?a.mod(this.m):a}function L(a){return a}function M(a){a.divRemTo(this.m,null,a)}function N(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function O(a,b){a.squareTo(b),this.reduce(b)}function P(){if(this.t<1)return 0;var a=this[0];if(0==(1&a))return 0;var b=3&a;return b=15&b*(2-(15&a)*b),b=255&b*(2-(255&a)*b),b=65535&b*(2-(65535&(65535&a)*b)),b=b*(2-a*b%this.DV)%this.DV,b>0?this.DV-b:-b}function Q(a){this.m=a,this.mp=a.invDigit(),this.mpl=32767&this.mp,this.mph=this.mp>>15,this.um=(1<<a.DB-15)-1,this.mt2=2*a.t}function R(a){var b=f();return a.abs().dlShiftTo(this.m.t,b),b.divRemTo(this.m,null,b),a.s<0&&b.compareTo(e.ZERO)>0&&this.m.subTo(b,b),b}function S(a){var b=f();return a.copyTo(b),this.reduce(b),b}function T(a){for(;a.t<=this.mt2;)a[a.t++]=0;for(var b=0;b<this.m.t;++b){var c=32767&a[b],d=c*this.mpl+((c*this.mph+(a[b]>>15)*this.mpl&this.um)<<15)&a.DM;for(c=b+this.m.t,a[c]+=this.m.am(0,d,a,b,0,this.m.t);a[c]>=a.DV;)a[c]-=a.DV,a[++c]++}a.clamp(),a.drShiftTo(this.m.t,a),a.compareTo(this.m)>=0&&a.subTo(this.m,a)}function U(a,b){a.squareTo(b),this.reduce(b)}function V(a,b,c){a.multiplyTo(b,c),this.reduce(c)}function W(){return 0==(this.t>0?1&this[0]:this.s)}function X(a,b){if(a>4294967295||1>a)return e.ONE;var c=f(),d=f(),g=b.convert(this),h=y(a)-1;for(g.copyTo(c);--h>=0;)if(b.sqrTo(c,d),(a&1<<h)>0)b.mulTo(d,g,c);else{var i=c;c=d,d=i}return b.revert(c)}function Y(a,b){var c;return c=256>a||b.isEven()?new J(b):new Q(b),this.exp(a,c)}function Z(){this.i=0,this.j=0,this.S=new window.Array}function $(a){var b,c,d;for(b=0;256>b;++b)this.S[b]=b;for(c=0,b=0;256>b;++b)c=255&c+this.S[b]+a[b%a.length],d=this.S[b],this.S[b]=this.S[c],this.S[c]=d;this.i=0,this.j=0}function _(){var a;return this.i=255&this.i+1,this.j=255&this.j+this.S[this.i],a=this.S[this.i],this.S[this.i]=this.S[this.j],this.S[this.j]=a,this.S[255&a+this.S[this.i]]}function ab(){return new Z}function bb(a){Cb[Db++]^=255&a,Cb[Db++]^=255&a>>8,Cb[Db++]^=255&a>>16,Cb[Db++]^=255&a>>24,Db>=Eb&&(Db-=Eb)}function cb(){bb((new window.Date).getTime())}function db(){if(null==Bb){for(cb(),Bb=ab(),Bb.init(Cb),Db=0;Db<Cb.length;++Db)Cb[Db]=0;Db=0}return Bb.next()}function eb(a){var b;for(b=0;b<a.length;++b)a[b]=db()}function fb(){}function gb(a,b){return new e(a,b)}function hb(a,b){if(b<a.length+11)return window.alert("Message too long for RSA"),null;for(var c=new window.Array,d=a.length-1;d>=0&&b>0;){var f=a.charCodeAt(d--);128>f?c[--b]=f:f>127&&2048>f?(c[--b]=128|63&f,c[--b]=192|f>>6):(c[--b]=128|63&f,c[--b]=128|63&f>>6,c[--b]=224|f>>12)}c[--b]=0;for(var g=new fb,h=new window.Array;b>2;){for(h[0]=0;0==h[0];)g.nextBytes(h);c[--b]=h[0]}c[--b]=2,c[--b]=0;var i=new e(c);return i}function ib(){this.n=null,this.e=0,this.d=null,this.p=null,this.q=null,this.dmp1=null,this.dmq1=null,this.coeff=null}function jb(a,b){null!=a&&null!=b&&a.length>0&&b.length>0?(this.n=gb(a,16),this.e=window.parseInt(b,16)):window.alert("Invalid RSA public key")}function kb(a){return a.modPowInt(this.e,this.n)}function lb(a){var b=hb(a,this.n.bitLength()+7>>3);if(null==b)return null;var c=this.doPublic(b);if(null==c)return null;var d=c.toString(16),e=d;return 0!=(1&d.length)&&(e="0"+e),e}function mb(a){var b="0123456789abcdef",c="";for(i=0;i<a.length;i++){var d=a.charCodeAt(i),e=d%16,f=d-e;f/=16,c+=b.substring(f,f+1)+""+b.substring(e,e+1)}return c}function nb(a){for(var b=new fb,c=new window.Array,d=0;a+1>d;d++)c[d]=0;b.nextBytes(c),c[0]=0;for(var f=new e(c).toString(16);f.length<16;)f="0"+f;for(;f.length<2*a;)f="0"+f;return f}function ob(a,b,e,f){var g=a,h=b,i=e,j=f,k="",l="",m="",n=0,o=0;m=i,n=m.indexOf("30818902818100"),o=m.lastIndexOf("0203010001"),o>0&&(m=m.substring(0,o),0==n&&(k=m.substring(13))),m=j,n=m.indexOf("30818902818100"),o=m.lastIndexOf("0203010001"),o>0&&(m=m.substring(0,o),0==n&&(l=m.substring(13)));var p=new ib;p.setPublic(k,"010001"),EK1=p.encrypt(g);for(var q=""+h+":"+EK1,r=mb(q),s=new fb,t=new window.Array,n=0;9>n;n++)t[n]=0;s.nextBytes(t),t[0]=0;var u=nb(8),v=new c;v.init(mb(u)),tmp="0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000",v.crypt(tmp);var w=v.crypt(r);p.setPublic(l,"010001"),cipher_sk=p.encrypt(u);for(var x="",n=0;n<cipher_sk.length;n+=2)x=cipher_sk.substring(n,n+2)+x;var y=function(a){for(var b=mb(a+"");b.length<16;)b+="00";return b},z="000000000000000000000000";z=nb(12);var A=z+x+"00";A=y(A.length/2)+A;var B=w;B=y(B.length/2)+B;var C=A+B;return C=d(C)}function pb(){for(var a=document.getElementsByTagName("meta"),b={},c=a.length-1;c>=0;c--)b[a[c].getAttribute("property")]=a[c].getAttribute("content");return{ts:b._eTs,aPK:b._ePk1,hPK:b._ePk2}}function qb(a){var b=pb(),c=b.hPK.substr(0,b.hPK.length-10).substr(14),d=new ib;return d.setPublic(c,"10001"),ob(a,b.ts,b.hPK,b.aPK)}c.prototype.rc4crypt=function(c,d){key=a(c),pt=a(d),s=new window.Array;for(var e=0;256>e;e++)s[e]=e;var f,g=0;for(e=0;256>e;e++)g=(g+s[e]+key[e%key.length])%256,f=s[e],s[e]=s[g],s[g]=f;e=0,g=0,ct=new window.Array;for(var h=0;h<pt.length;h++)e=(e+1)%256,g=(g+s[e])%256,f=s[e],s[e]=s[g],s[g]=f,ct[h]=pt[h]^s[(s[e]+s[g])%256];return b(ct)},c.prototype.init=function(b){key=a(b),s=new window.Array;for(var c=0;256>c;c++)s[c]=c;var d,e=0;for(c=0;256>c;c++)e=(e+s[c]+key[c%key.length])%256,d=s[c],s[c]=s[e],s[e]=d;this.i=0,this.j=0,this.s=s},c.prototype.crypt=function(c){pt=a(c),s=this.s,i=this.i,j=this.j,ct=new window.Array;for(var d=0;d<pt.length;d++)i=(i+1)%256,j=(j+s[i])%256,x=s[i],s[i]=s[j],s[j]=x,ct[d]=pt[d]^s[(s[i]+s[j])%256];return this.s=s,this.i=i,this.j=j,b(ct)};var rb,sb="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",tb="=",ub=0xdeadbeefcafe,vb=15715070==(16777215&ub);vb&&"Microsoft Internet Explorer"==navigator.appName?(e.prototype.am=h,rb=30):vb&&"Netscape"!=navigator.appName?(e.prototype.am=g,rb=26):(e.prototype.am=k,rb=28),e.prototype.DB=rb,e.prototype.DM=(1<<rb)-1,e.prototype.DV=1<<rb;var wb=52;e.prototype.FV=Math.pow(2,wb),e.prototype.F1=wb-rb,e.prototype.F2=2*rb-wb;var xb,yb,zb="0123456789abcdefghijklmnopqrstuvwxyz",Ab=new Array;for(xb="0".charCodeAt(0),yb=0;9>=yb;++yb)Ab[xb++]=yb;for(xb="a".charCodeAt(0),yb=10;36>yb;++yb)Ab[xb++]=yb;for(xb="A".charCodeAt(0),yb=10;36>yb;++yb)Ab[xb++]=yb;J.prototype.convert=K,J.prototype.revert=L,J.prototype.reduce=M,J.prototype.mulTo=N,J.prototype.sqrTo=O,Q.prototype.convert=R,Q.prototype.revert=S,Q.prototype.reduce=T,Q.prototype.mulTo=V,Q.prototype.sqrTo=U,e.prototype.copyTo=n,e.prototype.fromInt=o,e.prototype.fromString=q,e.prototype.clamp=r,e.prototype.dlShiftTo=A,e.prototype.drShiftTo=B,e.prototype.lShiftTo=C,e.prototype.rShiftTo=D,e.prototype.subTo=E,e.prototype.multiplyTo=F,e.prototype.squareTo=G,e.prototype.divRemTo=H,e.prototype.invDigit=P,e.prototype.isEven=W,e.prototype.exp=X,e.prototype.toString=t,e.prototype.negate=u,e.prototype.abs=v,e.prototype.compareTo=w,e.prototype.bitLength=z,e.prototype.mod=I,e.prototype.modPowInt=Y,e.ZERO=p(0),e.ONE=p(1),Z.prototype.init=$,Z.prototype.next=_;var Bb,Cb,Db,Eb=256;if(null==Cb){Cb=new window.Array,Db=0;var Fb;if("Netscape"==navigator.appName&&navigator.appVersion<"5"&&window.crypto){var Gb=window.crypto.random(32);for(Fb=0;Fb<Gb.length;++Fb)Cb[Db++]=255&Gb.charCodeAt(Fb)}for(;Eb>Db;)Fb=window.Math.floor(65536*window.Math.random()),Cb[Db++]=Fb>>>8,Cb[Db++]=255&Fb;Db=0,cb()}return fb.prototype.nextBytes=eb,ib.prototype.doPublic=kb,ib.prototype.setPublic=jb,ib.prototype.encrypt=lb,window.PassEncryptor={getData:pb},window.encryptorPassword=qb,qb}),define("pafweblib/pwdGrd/1.0.1/password-rule",[],function(require,exports,module){function getRegxByPatternCode(a){var b=[];return(a&PATTERN_DIGITAL)===PATTERN_DIGITAL&&b.push(REGX_MAP[""+PATTERN_DIGITAL]),(a&PATTERN_LOWERCASE)===PATTERN_LOWERCASE&&b.push(REGX_MAP[""+PATTERN_LOWERCASE]),(a&PATTERN_UPPERCASE)===PATTERN_UPPERCASE&&b.push(REGX_MAP[""+PATTERN_UPPERCASE]),(a&PATTERN_SPECIALCHAR)===PATTERN_SPECIALCHAR&&b.push(REGX_MAP[""+PATTERN_SPECIALCHAR]),new RegExp("^["+b.join("")+"]+$")}function getPasswordPatternCode(a){var b=-1,c=[];c.push(PATTERN_DIGITAL),c.push(PATTERN_LOWERCASE),c.push(PATTERN_DIGITAL|PATTERN_LOWERCASE),c.push(PATTERN_UPPERCASE),c.push(PATTERN_DIGITAL|PATTERN_UPPERCASE),c.push(PATTERN_LOWERCASE|PATTERN_UPPERCASE),c.push(PATTERN_DIGITAL|PATTERN_LOWERCASE|PATTERN_UPPERCASE),c.push(PATTERN_SPECIALCHAR),c.push(PATTERN_DIGITAL|PATTERN_SPECIALCHAR),c.push(PATTERN_LOWERCASE|PATTERN_SPECIALCHAR),c.push(PATTERN_DIGITAL|PATTERN_LOWERCASE|PATTERN_SPECIALCHAR),c.push(PATTERN_UPPERCASE|PATTERN_SPECIALCHAR),c.push(PATTERN_DIGITAL|PATTERN_UPPERCASE|PATTERN_SPECIALCHAR),c.push(PATTERN_LOWERCASE|PATTERN_UPPERCASE|PATTERN_SPECIALCHAR),c.push(PATTERN_DIGITAL|PATTERN_LOWERCASE|PATTERN_UPPERCASE|PATTERN_SPECIALCHAR),a&&""!==a||(b=0);for(var d=0;d<c.length;d++){var e=c[d];if(getRegxByPatternCode(e).test(a)){b=e;break}}return b}function getStrengthScoreByPatten(a,b){var c=-1;if(a&&b){var d=SCORE_MAP[a];for(var e in d)if(lengthRangeArray=e.split("~"),2==lengthRangeArray.length){var f=lengthRangeArray[0],g=lengthRangeArray[1];if(b>=f&&g>=b){c=d[e];break}}}return c}function getStrengthScoreByValue(a){var b=-1;if(!a||""===a)return b;var c=getPasswordPatternCode(a),d=a.length;return getStrengthScoreByPatten(c,d)}function getPatternNumber(value){var patternNumber=0;for(var patternKey in REGX_MAP){var regx=REGX_MAP[patternKey];eval("/["+regx+"]/.test('"+value+"')")&&(patternNumber+=1)}return patternNumber}var PATTERN_DIGITAL=1,PATTERN_LOWERCASE=2,PATTERN_UPPERCASE=4,PATTERN_SPECIALCHAR=8,REGX_MAP={};REGX_MAP[PATTERN_DIGITAL]="0-9",REGX_MAP[PATTERN_LOWERCASE]="a-z",REGX_MAP[PATTERN_UPPERCASE]="A-Z",REGX_MAP[PATTERN_SPECIALCHAR]="~!@#$%^&*();<>.?_/\\-`";var SCORE_MAP={};SCORE_MAP[PATTERN_DIGITAL]={"1~11":30,"12~16":60,"17~99":90},SCORE_MAP[PATTERN_SPECIALCHAR]={"1~8":30,"9~14":60,"15~99":90},SCORE_MAP[PATTERN_LOWERCASE]={"1~7":30,"8~13":60,"14~99":90},SCORE_MAP[PATTERN_UPPERCASE]={"1~7":30,"8~13":60,"14~99":90},SCORE_MAP[PATTERN_DIGITAL|PATTERN_SPECIALCHAR]={"1~7":30,"8~12":60,"13~99":90},SCORE_MAP[PATTERN_DIGITAL|PATTERN_LOWERCASE]={"1~7":30,"8~12":60,"13~99":90},SCORE_MAP[PATTERN_DIGITAL|PATTERN_UPPERCASE]={"1~7":30,"8~12":60,"13~99":90},SCORE_MAP[PATTERN_SPECIALCHAR|PATTERN_LOWERCASE]={"1~6":30,"7~11":60,"12~99":90},SCORE_MAP[PATTERN_SPECIALCHAR|PATTERN_UPPERCASE]={"1~6":30,"7~11":60,"12~99":90},SCORE_MAP[PATTERN_LOWERCASE|PATTERN_UPPERCASE]={"1~6":30,"7~11":60,"12~99":90},SCORE_MAP[PATTERN_DIGITAL|PATTERN_LOWERCASE|PATTERN_SPECIALCHAR]={"1~6":30,"7~10":60,"11~99":90},SCORE_MAP[PATTERN_DIGITAL|PATTERN_UPPERCASE|PATTERN_SPECIALCHAR]={"1~6":30,"7~10":60,"11~99":90},SCORE_MAP[PATTERN_DIGITAL|PATTERN_LOWERCASE|PATTERN_UPPERCASE]={"1~6":30,"7~10":60,"11~99":90},SCORE_MAP[PATTERN_SPECIALCHAR|PATTERN_LOWERCASE|PATTERN_UPPERCASE]={"1~6":30,"7~10":60,"11~99":90},SCORE_MAP[PATTERN_DIGITAL|PATTERN_SPECIALCHAR|PATTERN_LOWERCASE|PATTERN_UPPERCASE]={"1~5":30,"6~9":60,"10~99":90};var VALID_PASSWORD_REGX=getRegxByPatternCode(PATTERN_DIGITAL|PATTERN_LOWERCASE|PATTERN_UPPERCASE|PATTERN_SPECIALCHAR),BLACKLIST="112233,123123,123321,abcabc,abc123,a1b2c3,aaa111,123qwe,qwerty,qweasd,admin,password,p@ssword,passwd,iloveyou,5201314,12345qwert,12345QWERT,1qaz2wsx,password,qwerty,monkey,letmein,trustno1,dragon,baseball,111111,iloveyou,master,sunshine,ashley,bailey,passw0rd,shadow,superman,qazwsx,michael,football".split(","),passwordRules={entropyScore:function(a){return this.isInBlackList(a)?-1:getStrengthScoreByValue(a)},entropyScoreByPatternLength:function(a,b){return getStrengthScoreByPatten(a,b)},isInBlackList:function(a){for(var b=0;b<BLACKLIST.length;b++)if(a===BLACKLIST[b])return!0;return!1},validCharSet:function(a){return VALID_PASSWORD_REGX.test(a)},validCharSetGroup:function(a){return this.validCharSet(a)&&getPatternNumber(a)>=2},lessLength:function(a,b){var c=a||"",b=b||6;return c.length<b},moreLength:function(a){var b=a||"";return b.length>16}};return passwordRules});
