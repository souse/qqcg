define("consumer/applicationcenter-payment/1.0.0/payment",["jquery/jquery/1.10.2/jquery","pafweblib/temporary/1.0.0/numeral","$","pafweblib/FormValidator/0.2.1/FormValidator"],function(a,b,c){var d=a("jquery/jquery/1.10.2/jquery"),e=(a("pafweblib/temporary/1.0.0/numeral"),a("pafweblib/FormValidator/0.2.1/FormValidator")),f={init:function(){var a=/^(1[^012][0-9]{9})$/i,b=this,c=d("#receiverAccount"),e=d("#amount"),f=c.val().replace(/\s/g,"");c.numeral(),e.numeral({scale:2,intlen:12}),d(".textarea-count").each(function(){function a(){var a=c.prop("maxlength")||50,b=c.val().length;b>=a?(c.val(c.val().substring(0,a)),e.html(0)):e.html(a-b)}var b=d(this),c=d(b.data("textarea")),e=b.find(".textarea-left");c.keyup(a),a()}),b.checkForm(),""!=f&&a.test(f)&&b.getUserData()},getUserData:function(){var a=d("#receiverAccount").val();d.ajax({type:"POST",dataType:"JSON",data:{},url:window.contextPath+"/users/"+a,success:function(a){"D"===a.level?d("#receiverName").val(""):d("#receiverName").val(a.name)},error:function(){"undefined"!=typeof console&&console.log("applicationCenter-payment-payment-paymentInfo")}})},checkForm:function(){var a=this,b=new e("#paymentForm",{rules:{receiverAccount:"required|phone",amount:"required|gtZero",receiverName:"required"},messages:{receiverAccount:{required:"收款方壹钱包账户不能为空",phone:"收款方壹钱包账户为对方手机号码"},amount:{required:"付款金额不能为空",gtZero:"付款金额必须高于0元"},receiverName:{required:"收款方姓名不能为空"}},success:{receiverAccount:function(){a.getUserData()}}});b.extendRules({gtZero:function(a,b){return b=window.parseFloat(b),0>=b?!1:!0}}),b.launched()}};c.exports=f});
