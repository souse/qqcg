define("consumer/prepaidcard-charge/1.0.0/prepaidcard-charge",["$","Validator"],function(a,b,c){function d(a,b){if(void 0!=b.charCode){if(0!=b.charCode&&!a.test(String.fromCharCode(b.charCode)))return b.preventDefault(),!1}else if(0!=b.keyCode&&!a.test(String.fromCharCode(b.keyCode)))return b.preventDefault(),!1;return!0}var e=a("$"),f=(window.staticFileRoot,document);f.body;var g=function(){e(".js_submit").prop("disabled",!0),e(".js_submit").addClass("submitting")},h=function(){e(".js_submit").removeAttr("disabled"),e(".js_submit").removeClass("submitting")};a("Validator");var i=function(){try{var a;e(this),e("#chargeAmount").on("keypress",function(a){var b=/\d|\./;return d(b,a)}).on("keyup",function(){var b=e(this),c=e(".maxAccountAmt").val(),d=b.val();if(!/\d|\./g.test(d))return b.val(d.substr(0,d.length-1).replace(/[\u4e00-\u9fa5]/g,"").replace(/\D/g,"")),!1;if(d.replace(/\d|\./g,"").length>0)return b.val(d.replace(/[^\d|^\.]/g,"")),e(this).closest("span").siblings(".help-block").remove(),e(this).closest(".controls").append('<div class="help-block">请输入正确的金额!</div>'),e(this).closest(".controls").parent().addClass("control-group-error"),g(),!1;e(this).closest("span").siblings(".help-block").remove(),e(this).closest(".controls").removeClass("control-group-error"),b.val(a=b.val().replace(/\s/g,"").replace(/[\u4e00-\u9fa5]/g,""));var f=a.split("."),i=f.length,j="";if(2==i&&f[1]&&f[1].length>2){j=f[1].substr(-1),f[1]=f[1].substr(0,2);var k=f.join(".");j>4&&(k=parseFloat(k)+.01),e(this).val(parseFloat(k).toFixed(2)),g(),e(this).closest("span").siblings(".help-block").remove(),e(this).closest(".controls").append('<div class="help-block">小数点后四舍五入保留两位!</div>'),e(this).closest(".controls").parent().addClass("control-group-error")}else e(this).closest("span").siblings(".help-block").remove();return parseFloat(c)<1e6*parseFloat(a)?(e(this).closest("form").find(".formError").remove(),e(this).closest("form").prepend('<div class="formError"><span class="errorIcon">&nbsp;</span>你的卡要充爆了,请重新输入.</div>'),b.val(""),g(),void 0):(e(this).closest("form").find(".formError").remove(),h(),!0)}).on("validate",function(b,c){var d=e(this);if(e(".maxAccountAmt").val(),d.val(a=d.val().replace(/\s/g,"")),""===a||0==a&&!/[^\.]/g.test(a))return c.reject("请输入金额!"),g(),e(this).val(""),!1;var f=a.split("."),h=f.length;return h>2?(e(this).val((f.length=2)&&f.join(".")),g(),c.reject("输入数字不能有两个小数点!"),void 0):/^[0]{2,}/g.test(a)?(e(this).val(""),c.reject("数字输入开头不能有两个0!"),g(),void 0):(/^[0]+[1-9]/.test(a)&&e(this).val(a.substr(1)),a.length>0?(e(this).val(a.replace(/[^\d|^\.]/g,"")),void 0):void 0)}).on("blur",function(){var b=e(this);1e6*parseFloat(b.val())<=parseFloat(e(".maxAccountAmt").val())&&(e(this).closest("span").siblings(".help-block").remove(),e(this).val(parseFloat(a)),h())}),e("form#chargeForm").submit(function(){return e(".js_submit").hasClass("submitting")?!1:(e(".js_submit").addClass("submitting"),void 0)})}catch(b){window.console&&console.log("Initialize charge module error！")}};c.exports=i()});
