define("consumer/questionnaire-index/1.0.0/questionnaire-index",["global","$"],function(a,b){function c(){g.ajax({url:window.contextPath+"/data/questionnaire/radios.json",dataType:"json",headers:{Accept:"application/json; charset=utf-8"}}).done(function(a){if(a.selects.length>0&&a.answers){for(var b="",c=0;c<a.selects.length;c++){var d=a.selects[c],e=a.selects[c].options;b+='<div class="requiredParent"><div class="paf-box-head"><h3 class="paf-box-head-title"><span>* </span>'+d.name+"</h3></div>",b+='<div class="paf-box-container"><table><tr>',b+="<th>&nbsp;</th>";for(key in a.answers)b+="<th>"+a.answers[key]+"</th>";b+="</tr>";for(k1 in e){b+="<tr><td class='header w158'>"+e[k1]+"</td>";for(k2 in a.answers)b+="<td class='w108'><input type='radio' required name="+k1+" value="+k2+"></input></td>";b+="</tr>",l.push(k1)}b+="</table></div></div>"}h.append(b)}})}function d(){var a=i.val().length;j.html(a)}function e(){i.on("keyup blur change",function(){var a=g(this),b=a.attr("maxlength"),c=a.val().length;c>b&&a.val(a.val().substring(0,b)),d()}),g("#acctIdInput").on("validate",function(a,b){var c=g(this),d=c.val().trim()||"";return""==d||isPhone(d)?void 0:(b.reject("请输入真实的手机号"),!1)}),g("input.captchainput").on("validate",function(a,b){var c=g(this),d=c.val().trim()||"";return""===d?(b.reject("请输入验证码"),!1):void 0})}function f(){k.on("submit",function(){var a=g(this),b=g("input.captchainput"),c=b.val().trim()||"";if(a.hasClass("submitting"))return!1;if(""===c)return b.trigger("blur"),!1;if(a.find(".help-block.error").length)return!1;for(var d=0;d<l.length;d++){var e=g("form input[type='radio'][required][name="+l[d]+"]").parents("div.requiredParent"),f=e.find("h3.paf-box-head-title"),h=g("form input[type='radio'][required][name="+l[d]+"]:checked").length;if(0==h){var i=e.offset().top;return g("html").scrollTop(i-40),f.addClass("requireCss"),!1}f.removeClass("requireCss")}var j=g("#captcha\\.id").val(),k={id:j,captchaValue:g("input.captchainput").val()},m=g("input.captchainput").parent().parent(),n=!1;return m.find("div.help-block").remove(),g.ajax({dataType:"json",url:"/captcha/"+j+"/valid",data:k,async:!1,success:function(a){a?n=!0:m.append('<div class="help-block">请正确输入验证码</div>')},fail:function(){m.append('<div class="help-block">系统异常，验证码验证失效，请稍后刷新页面重</div>')}}),n?(a.addClass("submitting"),a.find('input[type="submit"]').val("正在提交，请稍候"),void 0):(g("a.refresh_captcha").trigger("click"),!1)})}a("global");var g=a("$"),h=g("#questionnaireRadios"),i=g("#suggestionText"),j=g("#suggestionNumSpan"),k=g("#questionnaireForm"),l=new Array;b.init=function(){d(),c(),e(),f()}});