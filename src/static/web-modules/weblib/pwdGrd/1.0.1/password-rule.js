define("pafweblib/pwdGrd/1.0.1/password-rule",[],function(require,exports,module){function getRegxByPatternCode(a){var b=[];return(a&PATTERN_DIGITAL)===PATTERN_DIGITAL&&b.push(REGX_MAP[""+PATTERN_DIGITAL]),(a&PATTERN_LOWERCASE)===PATTERN_LOWERCASE&&b.push(REGX_MAP[""+PATTERN_LOWERCASE]),(a&PATTERN_UPPERCASE)===PATTERN_UPPERCASE&&b.push(REGX_MAP[""+PATTERN_UPPERCASE]),(a&PATTERN_SPECIALCHAR)===PATTERN_SPECIALCHAR&&b.push(REGX_MAP[""+PATTERN_SPECIALCHAR]),new RegExp("^["+b.join("")+"]+$")}function getPasswordPatternCode(a){var b=-1,c=[];c.push(PATTERN_DIGITAL),c.push(PATTERN_LOWERCASE),c.push(PATTERN_DIGITAL|PATTERN_LOWERCASE),c.push(PATTERN_UPPERCASE),c.push(PATTERN_DIGITAL|PATTERN_UPPERCASE),c.push(PATTERN_LOWERCASE|PATTERN_UPPERCASE),c.push(PATTERN_DIGITAL|PATTERN_LOWERCASE|PATTERN_UPPERCASE),c.push(PATTERN_SPECIALCHAR),c.push(PATTERN_DIGITAL|PATTERN_SPECIALCHAR),c.push(PATTERN_LOWERCASE|PATTERN_SPECIALCHAR),c.push(PATTERN_DIGITAL|PATTERN_LOWERCASE|PATTERN_SPECIALCHAR),c.push(PATTERN_UPPERCASE|PATTERN_SPECIALCHAR),c.push(PATTERN_DIGITAL|PATTERN_UPPERCASE|PATTERN_SPECIALCHAR),c.push(PATTERN_LOWERCASE|PATTERN_UPPERCASE|PATTERN_SPECIALCHAR),c.push(PATTERN_DIGITAL|PATTERN_LOWERCASE|PATTERN_UPPERCASE|PATTERN_SPECIALCHAR),a&&""!==a||(b=0);for(var d=0;d<c.length;d++){var e=c[d];if(getRegxByPatternCode(e).test(a)){b=e;break}}return b}function getStrengthScoreByPatten(a,b){var c=-1;if(a&&b){var d=SCORE_MAP[a];for(var e in d)if(lengthRangeArray=e.split("~"),2==lengthRangeArray.length){var f=lengthRangeArray[0],g=lengthRangeArray[1];if(b>=f&&g>=b){c=d[e];break}}}return c}function getStrengthScoreByValue(a){var b=-1;if(!a||""===a)return b;var c=getPasswordPatternCode(a),d=a.length;return getStrengthScoreByPatten(c,d)}function getPatternNumber(value){var patternNumber=0;for(var patternKey in REGX_MAP){var regx=REGX_MAP[patternKey];eval("/["+regx+"]/.test('"+value+"')")&&(patternNumber+=1)}return patternNumber}var PATTERN_DIGITAL=1,PATTERN_LOWERCASE=2,PATTERN_UPPERCASE=4,PATTERN_SPECIALCHAR=8,REGX_MAP={};REGX_MAP[PATTERN_DIGITAL]="0-9",REGX_MAP[PATTERN_LOWERCASE]="a-z",REGX_MAP[PATTERN_UPPERCASE]="A-Z",REGX_MAP[PATTERN_SPECIALCHAR]="~!@#$%^&*();<>.?_/\\-`";var SCORE_MAP={};SCORE_MAP[PATTERN_DIGITAL]={"1~11":30,"12~16":60,"17~99":90},SCORE_MAP[PATTERN_SPECIALCHAR]={"1~8":30,"9~14":60,"15~99":90},SCORE_MAP[PATTERN_LOWERCASE]={"1~7":30,"8~13":60,"14~99":90},SCORE_MAP[PATTERN_UPPERCASE]={"1~7":30,"8~13":60,"14~99":90},SCORE_MAP[PATTERN_DIGITAL|PATTERN_SPECIALCHAR]={"1~7":30,"8~12":60,"13~99":90},SCORE_MAP[PATTERN_DIGITAL|PATTERN_LOWERCASE]={"1~7":30,"8~12":60,"13~99":90},SCORE_MAP[PATTERN_DIGITAL|PATTERN_UPPERCASE]={"1~7":30,"8~12":60,"13~99":90},SCORE_MAP[PATTERN_SPECIALCHAR|PATTERN_LOWERCASE]={"1~6":30,"7~11":60,"12~99":90},SCORE_MAP[PATTERN_SPECIALCHAR|PATTERN_UPPERCASE]={"1~6":30,"7~11":60,"12~99":90},SCORE_MAP[PATTERN_LOWERCASE|PATTERN_UPPERCASE]={"1~6":30,"7~11":60,"12~99":90},SCORE_MAP[PATTERN_DIGITAL|PATTERN_LOWERCASE|PATTERN_SPECIALCHAR]={"1~6":30,"7~10":60,"11~99":90},SCORE_MAP[PATTERN_DIGITAL|PATTERN_UPPERCASE|PATTERN_SPECIALCHAR]={"1~6":30,"7~10":60,"11~99":90},SCORE_MAP[PATTERN_DIGITAL|PATTERN_LOWERCASE|PATTERN_UPPERCASE]={"1~6":30,"7~10":60,"11~99":90},SCORE_MAP[PATTERN_SPECIALCHAR|PATTERN_LOWERCASE|PATTERN_UPPERCASE]={"1~6":30,"7~10":60,"11~99":90},SCORE_MAP[PATTERN_DIGITAL|PATTERN_SPECIALCHAR|PATTERN_LOWERCASE|PATTERN_UPPERCASE]={"1~5":30,"6~9":60,"10~99":90};var VALID_PASSWORD_REGX=getRegxByPatternCode(PATTERN_DIGITAL|PATTERN_LOWERCASE|PATTERN_UPPERCASE|PATTERN_SPECIALCHAR),BLACKLIST="112233,123123,123321,abcabc,abc123,a1b2c3,aaa111,123qwe,qwerty,qweasd,admin,password,p@ssword,passwd,iloveyou,5201314,12345qwert,12345QWERT,1qaz2wsx,password,qwerty,monkey,letmein,trustno1,dragon,baseball,111111,iloveyou,master,sunshine,ashley,bailey,passw0rd,shadow,superman,qazwsx,michael,football".split(","),passwordRules={entropyScore:function(a){return this.isInBlackList(a)?-1:getStrengthScoreByValue(a)},entropyScoreByPatternLength:function(a,b){return getStrengthScoreByPatten(a,b)},isInBlackList:function(a){for(var b=0;b<BLACKLIST.length;b++)if(a===BLACKLIST[b])return!0;return!1},validCharSet:function(a){return VALID_PASSWORD_REGX.test(a)},validCharSetGroup:function(a){return this.validCharSet(a)&&getPatternNumber(a)>=2},lessLength:function(a,b){var c=a||"",b=b||6;return c.length<b},moreLength:function(a){var b=a||"";return b.length>16}};return passwordRules});
