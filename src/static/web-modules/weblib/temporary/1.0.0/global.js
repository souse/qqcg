function NS(a,b){for(var c=a.split("."),d=window,e=c.length,f=0;e>f;)d=d[c[f]]=d[c[f++]]||{};b.call(d)}function fmoney(a,b){b=b>0&&20>=b?b:2,a=parseFloat((a+"").replace(/[^\d\.-]/g,"")).toFixed(b)+"";var c,d=a.split(".")[0].split("").reverse(),e=a.split(".")[1];for(t="",c=0;c<d.length;c++)t+=d[c]+(0==(c+1)%3&&c+1!=d.length?",":"");return t.split("").reverse().join("")+"."+e}function rmoney(a){return parseFloat(a.replace(/[^\d\.-]/g,""))}function padFront(a,b,c){for(var d=c.length;a>d;++d)c=b+c;return c}function formatDate(a){var b=new Date(a);return[b.getFullYear(),padFront(2,"0",b.getMonth()+1),padFront(2,"0",b.getDay())].join(".")}function isPhone(a){var b=a.toString().replace(/\s/g,""),c=/^(1[^012][0-9]{9})$/i;return c.test(b)}function userAgent(){var a=navigator.userAgent;a=a.toLowerCase();var b=/(webkit)[ \/]([\w.]+)/.exec(a)||/(opera)(?:.*version)?[ \/]([\w.]+)/.exec(a)||/(msie) ([\w.]+)/.exec(a)||!/compatible/.test(a)&&/(mozilla)(?:.*? rv:([\w.]+))?/.exec(a)||[];switch(b[1]){case"msie":return"msie";case"webkit":return"safari_or_chrome";case"opera":return"opera";case"mozilla":return"Firefox";default:return!1}}String.prototype.trim||(String.prototype.trim=function(){return this.replace(/^\s+|\s+$/g,"")}),Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){var c,d,e=b?b:0;if(!this)throw new TypeError;if(d=this.length,0===d||e>=d)return-1;for(0>e&&(e=d-Math.abs(e)),c=e;d>c;c++)if(this[c]===a)return c;return-1});var PINGAN={};PINGAN.META={},PINGAN.META.custId=$("meta[name=custId]").prop("content"),function(a){function b(b,c,d){var e=c+":"+b;h[e]&&h[e].done(d);var f=a.Deferred();h[e]=f.promise(),d&&h[e].done(d),a.ajax({url:b,dataType:"text json",type:c,headers:{Accept:"application/json; charset=utf-8"}}).done(function(a,b,c){4===c.readyState&&f.resolve(a,c)})}function c(b){return function(){var c=b.data("sendOTPCount");0>=c--?(a(b).html(b.data("sendOTPOrigHtml")).prop("disabled",null),clearInterval(b.data("sendOTPtimeout")),sendOTPtimeout=void 0):a(b).html(c+"秒"),b.data("sendOTPCount",c)}}function d(b){var c=a(b),d=c.val().trim(),e=a((c.data("type")||"").replace(/[.]/g,"\\.")),f=e.val()||"CHINA_IDENTIFICATION_CARD";if(g(c,"user.tooyoung"),g(c,"idCard"),!(d.length<=0)&&"CHINA_IDENTIFICATION_CARD"===f){a(".password-ruled").data("bdYear",void 0).data("bdMonth",void 0).data("bdDate",void 0);var h=d.length;if(18===h||15===h)if(18===h){/\d{17}[\dxX]/.test(d);for(var i=function(a,b,c){return(b+c-a%b)%b},j=function(a,b){return a*(Math.pow(2,b-1)%11)},k=0,l=0;17>l;l++)k+=j(+d.charAt(l),18-l);var m=d.charAt(17),n=i(k,11,1);if(0===m-n||"X"===m&&10===n){var o=[parseInt(d.substring(6,10)),parseInt(s=d.substring(10,12))-1,parseInt(t=d.substring(12,14))],p=new Date,q=new Date(p.getFullYear()-10,p.getMonth(),p.getDate());return o=new Date(o[0],o[1],o[2]),o>q?2:(a(".password-ruled").data("bdYear",o.getFullYear()).data("bdMonth",o.getMonth()+1).data("bdDate",o.getDate()),void 0)}}else if(15===h){var r,s,t,u=/[1-9]\d{5}(\d{2})(\d{2})(\d{2})\d{3}/;return r=d.match(u),1}return 0}}function e(b,c){if(c){for(var d=a(b),e=d.data("errors")||{},f=0;f<c.length;f++)e[c[f][0]]=c[f][1];d.data("errors",e)}}function f(b,c,d){var e=a(b),f=a(b).data("errors")||{},g=e.parent().parent().children(".help-block.error");if(g.children().remove(),f||c){0===g.length&&(g=a('<div class="help-block error"></div>')),g.detach();var h=0;for(var i in f)++h,a('<span class="error-container" style="float:left; clear:both;" data-error-name="'+i+'">'+f[i]+"</span>").appendTo(g);(h>0||c)&&(e.parents(".form-group").first().addClass("error"),h>0&&(g.appendTo(e.parent().parent()),g.is(":hidden")&&g.slideDown(100)))}else e.parents(".form-group").first().removeClass("error")}function g(b,c){var d=a(b),e=d.data("errors")||{},f=0;if(c){e=d.data("errors")||{};for(var g in e)0===g.indexOf(c)?(d.parents(".form-group").find('.error-container[data-error-name="'+g+'"]'),delete e[g]):++f;d.data("errors",e)}else{for(var g in e)d.parents(".form-group").find(".error-container[data-error-name="+g+"]");e={},d.data("errors",{})}0>=f&&d.parents(".form-group").first().removeClass("error")}a(".passwordHolder").each(function(){var b=a(this).find(".password-ruled").prop("name");a(this).append("<div class='strongShow'><span class='s1'>极弱</span><span class='s2'>弱</span><span class='s3'>中</span><span class='s4'>强</span></div>"),a(this).append('<input type="hidden" class="strength" name="'+b+'Strength" value="" />')});var h={};a.fn.dynData=function(c){var d=a(this),e=this;d.length<=0||b(d.data("path"),d.data("method"),function(a,b){c.call(e,a,b)})},a(".dynData").each(function(){var c=a(this);b(c.data("path"),c.data("method"))}),a(".refresh_captcha").click(function(){var b=this;return a(b).attr("clickValid")||(a(b).attr("clickValid",!0),setTimeout(function(){a.ajax({url:window.contextPath+"/captcha",dataType:"json",method:"POST"}).done(function(c){var d=a(b),e=a("#"+d.data("id").replace(/[.]/g,"\\.")),f=d.parent().find(".captcha");f.prop("src",c.img),e.prop("value",c.id)}),a(b).removeAttr("clickValid")},1e3)),!1}),a(".otpSend").each(function(){var b=a(this);b.click(function(){var d=b.data("sendOTPCount")||0,e=b.data("otp-path")||window.contextPath+"/otp/";if(void 0!==b.prop("disabled")&&0>=d){var f,g,h={};if(b.data("mobile")&&(f=a(b.data("mobile").replace(/[.]/g,"\\."))),f&&f.length>0){if(g=f.val(),!isPhone(g))return a("#moblie-error-tip").html("请输入真实的手机号").show(),!1;h.mobile=g,h.captchaId=a("#captcha\\.id").val(),h.captchaValue=a("#captcha\\.captchaValue").val()}a.post(e,h,function(c){return void 0==c.id?(a("#moblie-error-tip").html("该手机号已经注册过").show(),a(b).html(b.data("sendOTPOrigHtml")).prop("disabled","disabled"),a("#captcha\\.captchaValue").val(""),b.data("sendOTPtimeout")&&(b.data("sendOTPCount",0),clearInterval(b.data("sendOTPtimeout")),sendOTPtimeout=void 0),!1):(a("#moblie-error-tip").html("").hide(),a(b.data("id")).val(c.id),void 0)},"json").fail(function(a,c,d){d&&b.trigger("error",d)}).done(function(){var a=c(b);b.prop("disabled","disabled"),b.data("sendOTPCount",61).data("sendOTPtimeout",setInterval(a,1e3)),a()})}}).data("sendOTPOrigHtml",b.html())}),a(".textarea-count").each(function(){function b(){var a=d.prop("maxlength")||50,b=d.val().length;b>=a?(d.val(d.val().substring(0,a)),e.html(0)):e.html(a-b)}var c=a(this),d=a(c.data("textarea")),e=c.find(".textarea-left");d.keyup(b),b()}),PINGAN.utils=PINGAN.utils||{},PINGAN.utils.displayErrors=f,PINGAN.utils.clearErrors=g,PINGAN.utils.addErrors=e,a('[name="mobile"]').on("validate",function(b,c){var d=a(this);return""===d.val()?(c.reject("请输入您的手机号"),!1):isPhone(d.val())?void 0:(c.reject("请输入真实的手机号"),!1)}),a('[name="name"]').on("validate",function(b,c){var d=a(this);return""===d.val()?(c.reject("请输入您的真实姓名"),!1):d.val().length>20?(c.reject("姓名不能超过20个字"),!1):void 0}),a(".idCard").on("validate",function(b,c){var e=a("#changeIdNum").length>0&&"0"==a("#changeIdNum").val()?!0:!1;if(!e){if(""===a(this).val())return c.reject("请输入正确的身份证号"),!1;if(0===d(this))return c.reject("请输入正确的身份证号"),!1;if(1===d(this))return c.reject("请输入正确的18位数身份证号"),!1;if(2===d(this))return c.reject("用户必须是10岁以上"),!1}}),a("[data-matching-group]").each(function(){var b=a(this).data("matchingGroup"),c=a('[data-matching-group="'+b+'"]'),d=c.last();d.on("validate",function(d,e){if(!(c.length<2)){var f,g;c.each(function(){if(f){if(g=a(this).val(),f!==g&&""!==g)return e.reject(b+"不一致"),!1}else f=a(this).val()})}})})}(jQuery),$.fn.numeral=function(){var a=arguments,b="object"==typeof a[0],c=b?a[0].scale:a[0];c=c||0,$(this).css("ime-mode","disabled");var d=new Array(8,9,35,36,37,38,39,40,46);this.bind("keydown",function(a){a=window.event||a;var b=a.which||a.keyCode;if(a.shiftKey)return!1;var e=Array.indexOf(d,b);if(-1!=e)return!0;var g=this.value;if(190==b||110==b)return 0==c||-1!=g.indexOf(".")?!1:!0;if(b>=48&&57>=b||b>=96&&105>=b){if(c>0&&-1!=g.indexOf(".")){var h=new RegExp("^[0-9]+(.[0-9]{0,"+(c-1)+"})?$"),i=f();if(i!=g&&!h.test(g))return!1}return!0}return!1}),this.bind("blur",function(){if(this.value.lastIndexOf(".")==this.value.length-1)this.value=this.value.substr(0,this.value.length-1);else if(isNaN(this.value))this.value="";else{var a=this.value;if(c>0&&-1!=a.indexOf(".")){var b=new RegExp("^[0-9]+(.[0-9]{0,"+c+"})?$");b.test(a)||(this.value=e(a,c))}}}),this.bind("paste",function(){var a=window.clipboardData.getData("text");return!/\D/.test(a),value=a.replace(/^0*/,""),!1}),this.bind("dragenter",function(){return!1});var e=function(a,b){return Math.round(a*Math.pow(10,b))/Math.pow(10,b)},f=function(){return window.getSelection?window.getSelection():document.selection?document.selection.createRange().text:""};Array.indexOf=function(a,b){for(var c=0;c<a.length;c++)if(b==a[c])return c;return-1}},function(a){function b(b,c){return a('<span class="error-container" style="float:left; clear:both;" data-error-name="'+c+'">'+c+"</span>")}function c(b){var c=a(b),d=a(b).parent().parent().children(".help-block.error"),e=c.closest(".form-group");d.children().remove(),e.removeClass("error"),a(b).data("validationContext",{})}function d(c,d){var f=a(c),g=a(c).data("validationContext")||{},h=f.parent().parent().children(".help-block.error");if(f.parent().parent().children(".help-block").remove(),h.children().remove(),g){0===h.length&&(h=a('<div class="help-block error"></div>')),h.detach();var i=0;for(var j in g)++i,j in e?e[j](c,j,d.errors[j]).appendTo(h):b(c,j,d.errors[j]).appendTo(h);i>0&&(f.closest(".form-group").addClass("error"),h.appendTo(f.parent().parent()),h.is(":hidden")&&h.slideDown(100))}else f.closest(".form-group").removeClass("error")}var e={},f=function(b){this.errors={},this.hasErrors=!1,this.el=a(b)};f.prototype.reject=function(a,b){var c=this.el.data("validationContext")||{};this.hasErrors=!0,c[a]=b,this.el.data("validationContext",c)},a("body").on("change blur keyup","textarea, input ",function(){var b=a(this);clearTimeout(b.data("validationTimeout")),b.data("validationTimeout",setTimeout(function(){if(b.trigger("beforeValidate"),b.data("validationOldValue")!==b.val()){c(b),b.data("validationOldValue",b.val());var a=new f(b);b.trigger("validate",a),d(b,a),b.trigger("afterValidate",a)}},500))}),a("form").on("click","input[type=submit], input[type=button], button",function(b){return a(this).closest("form").hasClass("submitting")?b.preventDefault():void 0}),a('form:not(".simpleForm")').on("submit",function(b){var c=a(this),e=!1;return c.hasClass("submitting")?b.preventDefault():(c.find(".help-block.error").length?e=!0:a(this).find("textarea, input").each(function(){var b=a(this),c=new f(b);b.trigger("validate",c),d(b,c),c.hasErrors&&(e=!0),b.trigger("afterValidate",c)}),c.trigger("afterValidate",e),e?b.preventDefault():(c.addClass("submitting"),c.find('button[type="submit"]:not(".searchBtn")').text("正在提交，请稍候"),c.find('input[type="submit"]').val("正在提交，请稍候")),void 0)}),a(".password-ruled").on("change blur keyup",function(){a(this).trigger("afterValidate")})}(jQuery),"function"==typeof define&&define("global",[],function(){});
